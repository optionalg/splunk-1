source=Prod AND sourcetype=syslog AND process=httpd NOT OktaClass="*" NOT agentVersion="*" NOT OktaAdAgentId="*" AND OktaCrtrUserAgent="*" 
 | rex field=_raw "httpd\[(?<pro>.*)\]\: (?<sip>.*) - -"
 | eval SCANNER=case(match(agent, "/*WhiteHat Security*/"), "WhiteHat", 
                     match(agent, "/*Nikto\/*/") ,"Nikto", 
                     match(agent, "/*Nessus*/"),"Nessus", 
                     match(agent, "/*Havij*/"),"Havij", 
                     match(agent, "/*Sucuri Integrity*/"),"Sucuri Integrity Monitor", 
                     match(agent, "/*SiteLockSpider*/"),"SiteLockSpider", 
                     match(agent, "/*Burp*/"), "Burp", 
                     match(agent, "/*AppScan*/"), "AppScan")
 | where SANNER="*"
 | table SCANNER sip OktaCrtrUserAgent
 
 
 
 /* Original scanner user agents matches - courtsey Mattias Brutti */
